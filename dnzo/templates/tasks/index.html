{% extends "layouts/base.html" %}

{% load tasks_library %}

{% block page_title %}Dnzo: {{ task_list.name|escape }}{% if filter_title %} / {{ filter_title|escape }}{% endif %}{% endblock %}

{% block switcher %}
<div id="switcher_holder">
  / <select id="switcher">
    {% for list in task_lists %}
      <option value="{% url tasks.views.tasks_index user.short_name,list.short_name %}"
              {% ifequal list.key.id task_list.key.id %} selected{% endifequal %}>{{ list.name|escape }}</option>
    {% endfor %}
    </select>
    <a href="{% url tasks.views.lists_index user.short_name %}">Manage task lists</a>
</div>
{% endblock %}

{% block header %}
  {% if filter_title %}<a href="{% url tasks.views.tasks_index user.short_name,task_list.short_name %}">{% endif %}
  {{ task_list.name|escape }}{% if filter_title %}</a> / {{ filter_title|escape }}{% endif %}
{% endblock %}

{% block content %}
  <div id="tasks_holder">
    <form action="{% url tasks.views.task user.short_name,task_list.short_name %}" method="POST" id="tasks_form">
    <table cellspacing="0" cellpadding="0" id="tasks_list">
      <tr>
        <th><a href="#">&nbsp;&nbsp;âœ“</a></th>
        {% sorting_header "Project"     "project"    order direction "project" %}
        {% sorting_header "Task"        "body"       order direction "body" %}
        <th class="context"><a href="#">Context</a></th>
        {% sorting_header "Due"         "due_date"   order direction "due" %}
        {% sorting_header "Created On"  "created_at" order direction "created" %}
        <th class="edit"></th>
      </tr>
      {% for task in tasks %}
        {% include "tasks/task.html" %}
      {% endfor %}
      <tr id="add_row">
        <td></td>
        <td colspan="6"><a id="add" href="{{ add_url }}">Add task</a></td>
      </tr>
    </table>
    </form>

    <form action="{% url tasks.views.purge_tasks user.short_name,task_list.short_name %}" method="POST">
      <input type="submit" value="Archive complete tasks">
    </form>
  </div>
{% endblock %}